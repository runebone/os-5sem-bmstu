2-я часть 1й ЛР сдаётся в виде письменного отчёта.
В этой ЛР 2 части.

1-я часть:
Функция обработки прерывания от системного таймера, системы разделения времени (Windows и Unix/Linux - системы разделения времени).

Для написания отчёта используются Соломон-Русинович и Вахалия.

В 1й части отчёта будет функция обработки прерываний от системного таймера Windows и отдельно функция обработки прерываний от системного таймера Unix/Linux.

Можно выделить фукнции обработки прерывания:
- по тику
- по главному тику
- по кванту (квант - отрезок времени, меряется в тиках)

// Основное отличие систем разделения времени - время квантуется.

Функция обработки прерывания таймера в системах разделения времени должна выполнять декремент кванта.
Декремент кванта выполняется по тику.
Главный тик равен нескольким тикам.
Главных тиков в системе может быть несколько (например, раз в секунду главный тик).

В Windows информация по функциям обработчика размазана по тексту.
Но в оглавлении слово "Таймер" должно быть.

У Вахалии существует параграф "Таймер", но он никуда не годится, там просто написано неправильно.

Обработчик прерывания от системного таймера работает на высочайшем уровне привелегий; должно выполняться от начала до конца; быстрое прерывание; никаких других работ выполняться не может; должен завершиться как можно быстрее; может только иниц. отложенные действия путём постановки в очередь модулей ядра, в частности, планировщика.

В Windows это делается через DPC (different procedure call).
В Unix/Linux ориентироваться на Вахалию; параграф за основу берём, но понимать, что это не вызов, а инициализация отложенного выполнения - постановка в очередь.

Декремент кванта - основная функция обработчика таймера.
По истечению кванта система должна передать квант другому процессу (первому из очереди готовых процессов) - диспечеризация - основная задача; при этом мы должны понимать, что когда истёк квант, поздно пересчитывать приоритеты.

Windows и Unix/Linux - системы с динамическими приоритетами; это значит, что приоритеты могут изменяться в процессе выполнения; но динамические приоритетмы могут иметь только процессы уровня пользователя; при этом во всех этих системах учитывается время простоя процесса в очереди готовых процессов - исключается бесконечное откладывание.

Приоритеты пересчитываются по главному тику, заранее, при истечении кванта поздно пересчитывать приоритеты.

Иниц. планировщика - одна из функций прерывания системного таймера.

В Unix существует планировщик, в Windows - нет.
Задачи планировщика время от времени выполняют разные части кода ядра системы => код Windows не структурирован.

В книгах всё есть, читать; задача ЛР - работа с технической литературой.

В Unix/Linux существует page-daemon (в Windows - swapper), который заранее выгружает страницы, к которым дольше всего не было обращений по алгоритму LRU, чтобы иметь возможность без задержки загрузить нужную страницу при возникновении страничного прерывания; выполняется по главному тику (не цитировать, найти информацию в книгах).

По главному тику иниц. работа page daemon-а (установили период sleep - пробуждается время от времени).
Демон может пробуждаться по сигналу.

2-я часть - пересчёт приоритетов, динамические приоритеты.
Мы пишем по Вахалии (Unix, не Linux), Windows.
У Вахалии приводится пересчёт приоритетов по формуле, мы её берём, она содержит изучаемую нами информацию.
В этой формуле учитывается время полураспада, это время учитывает время простоя процесса в очереди и полученное процессом процессорное время => приоритет понижается, а у тех, что стоят в очереди приоритет повышается - это исключает бесконечное откладывание.

В Windows не пересчитываются приоритеты по формуле - сканируется очередь готовых процессов; тем процессам, которые находятся в очереди больше 4х секунд, повышается приоритет - исключается бесконечное откладывание.

В Windows поддерживаются очереди RR.

В Windows (Соломон-Русинович) на первое место выносят потоки.
Но единицей декомпозиции системы является процесс; процесс является владельцем ресурсов.
Сначала про процесс написать, потом про потоки.

Процесс при создании получает приоритет; приоритет потоков - назначается относительно приоритета процессов.

Приоритет процесса зависит не только от полученного процессорного времени и времени простоя; также зависит от того, на каком действии процесс был блокирован.

// В Windows существует блокировка на звуковой карточке, мьютексе, семафоре, мышке - есть у Робачевского - табличка повышения приоритетов процессов.

Классическое ядро Unix является невытесняемым (переключиться на выполнение процесса реального времени, пока выполняется код ядра, нельзя) - это мешало использованию ОС при выполнении процессов реального времени - такие ожидания недопустимы.

Современные ядра Unix полностью вытесняемые.
Unix SystemV - определены точки вытеснения.

Завершаем отчёт выводами.
Три предложения, основные мысли, которые должны вынести в результате выполнения ЛР.
